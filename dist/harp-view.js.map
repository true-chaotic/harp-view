{"version":3,"sources":["helpers/insertAfter.js","helpers/translate.js","helpers/tuneValid.js","helpers/createElement.js","viewer/index.js","vendor/ion.sound.js","player.js","helpers/noop.js","ticker.js","controller-view.js","helpers/isPause.js","controller.js","harp-view.js"],"names":["insertAfter","newNode","referenceNode","parentNode","insertBefore","nextSibling","translate","translations","lang","key","tuneValid","tune","Boolean","createElement","name","classes","listeners","element","document","classesArray","classList","add","Object","keys","forEach","event","addEventListener","styles","styleAdded","addStyles","style","innerHTML","head","appendChild","getNoteModifier","note","replace","baseContainerClass","baseNoteClass","activeClass","Viewer","notes","$column","$el","elements","split","reduce","result","index","arr","length","noteContainer","noteElement","innerText","highLighted","Set","dim","remove","delete","highLight","dimAll","window","navigator","$","undefined","ion","sound","warn","text","console","log","d","a","html","extend","parent","child","prop","hasOwnProperty","Audio","func","play","stop","pause","preload","destroy","is_iOS","i","test","appVersion","sounds_num","settings","sounds","supported","options","obj","path","volume","multiplay","loop","sprite","scope","ready_callback","ended_callback","alias","Sound","init","VERSION","_method","method","ionSound","AudioContext","audio","webkitAudioContext","request","streams","ext","url","loaded","decoded","no_file","autoplay","prototype","load","stream","buffer","removeEventListener","ready","bind","error","abort","createUrl","no_cache","Date","valueOf","encodeURIComponent","XMLHttpRequest","open","responseType","send","reload","data","target","readyState","status","decode","decodeAudioData","response","setBuffer","config","duration","call","start","end","Stream","part","setVolume","sprite_part","setLoop","source","gain","playing","paused","time_started","time_ended","time_played","time_offset","disconnect","update","createGain","createBufferSource","connect","destination","value","onended","ended","_play","clear","noteOn","noteOff","_ended","item","can_play_mp3","canPlayType","can_play_ogg","can_play_aac","splice","checkSupport","inited","_ready","_scope","start_time","paused_time","played_time","can_play_through","_update","rand","src","currentTime","e","current_time","setTimeout","looper","jQuery","Player","NOTES","SNAP","C","D","E","F","G","A","B","c","f","g","instance","GlobalPlayer","soundFolder","values","map","playNote","playSnap","noop","second","minute","Ticker","interval","ticksPerMinute","onTick","tpm","clearInterval","setInterval","ControllerView","onPlay","onStop","onClickSlower","onClickFaster","viewerElement","block","state","bpm","playButton","click","updateButton","controlSpeed","assign","display","margin","slowerBtn","fasterBtn","bpmElement","updateBpm","viewerContainer","maxWidth","updateElement","newState","entries","isPause","PAUSES","has","Controller","ticker","controllerView","tick","tuneIndex","ticksPerMinuteSteps","multiplier","Math","round","currentTicksStep","findIndex","modifiers","tuneArray","symbol","includes","pop","push","viewer","player","speedStep","increment","max","min","HarpView","selector","querySelectorAll","node","trim"],"mappings":"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","file":"harp-view.js","sourceRoot":"..\\src","sourcesContent":["/**\r\n * insertAfter helper\r\n *\r\n * @param {Element} newNode\r\n * @param {Element} referenceNode\r\n */\r\nexport default function insertAfter(newNode, referenceNode) {\r\n  referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\r\n}\r\n","const translations = {\r\n  'en': {\r\n    'error.bad-tune': \"Empty tune or unknown format\",\r\n    'play': 'Play',\r\n    'pause': 'Pause',\r\n    'stop': 'Stop'\r\n  },\r\n\r\n  'ru': {\r\n    'error.bad-tune': 'Пустая мелодия или ошибка в записи',\r\n    'play': 'Играть',\r\n    'pause': 'Пауза',\r\n    'stop': 'Остановить'\r\n  }\r\n};\r\n\r\nconst lang = 'en';\r\n\r\n/**\r\n * Translate by key\r\n *\r\n * @param key\r\n * @returns {string}\r\n */\r\nconst translate = key =>\r\n  translations\r\n  && translations[lang]\r\n  && translations[lang][key]\r\n  || key;\r\n\r\nexport default translate;\r\n","/**\r\n * Validates tune\r\n *  - not empty\r\n *  @TODO: conforms to chosen standard (e.g. abc)\r\n *\r\n * @param {string} tune\r\n * @returns {boolean}\r\n */\r\nexport default function tuneValid(tune) {\r\n  return Boolean(tune);\r\n}\r\n","/**\r\n * Creates element with class and listeners\r\n *\r\n * @param {string} name\r\n * @param {string|array} [classes=[]]\r\n * @param {object} [listeners={}]\r\n * @returns {Element}\r\n */\r\nexport default function createElement(name, classes = [], listeners = {}) {\r\n  const element = document.createElement(name);\r\n  const classesArray = typeof classes === 'string'\r\n    ? [classes]\r\n    : classes;\r\n\r\n  element.classList.add(...classesArray);\r\n\r\n  Object.keys(listeners).forEach(event => {\r\n    element.addEventListener(event, listeners[event]);\r\n  });\r\n\r\n  return element;\r\n}\r\n","import createElement from \"../helpers/createElement\";\r\n\r\nimport fs from 'fs';\r\nconst styles = fs.readFileSync(__dirname + '/notes-viewer.css', 'utf8');\r\n\r\nlet styleAdded = false;\r\n\r\nconst addStyles = () => {\r\n  if (styleAdded) {\r\n    return;\r\n  }\r\n\r\n  const style = document.createElement('style');\r\n\r\n  style.innerHTML = styles;\r\n\r\n  document.head.appendChild(style);\r\n\r\n  styleAdded = true;\r\n};\r\n\r\nconst getNoteModifier = note => note\r\n  .replace('\\'', '-high')\r\n  .replace(',', '-low');\r\n\r\nconst baseContainerClass = 'notes-viewer__container';\r\nconst baseNoteClass = 'notes-viewer__note';\r\nconst activeClass = `${baseNoteClass}_active`;\r\n\r\nexport default function Viewer() {\r\n  // const notes = \"F, C, D, E, F G A B c d e f | g a b c' d' e' f' g' a' x\";\r\n\r\n  const notes = \"| e c A F D B, G, E, D, C, F,, | x a g f d B G E C A, F, |\";\r\n\r\n  const $el = createElement('div', 'notes-viewer');\r\n\r\n  addStyles();\r\n\r\n  let $column;\r\n\r\n  const elements = notes\r\n    .split(' ')\r\n    .reduce((result, note, index, arr) => {\r\n      if (note === '|') {\r\n        if ($column) {\r\n          $el.appendChild($column);\r\n        }\r\n\r\n        if (index !== arr.length - 1) {\r\n          $column = createElement('ul', 'notes-viewer__column');\r\n        }\r\n      } else {\r\n        const noteContainer = createElement('li', [\r\n          baseContainerClass,\r\n          `${baseContainerClass}_${getNoteModifier(note)}`\r\n        ]);\r\n\r\n        const noteElement = createElement('span', baseNoteClass);\r\n        noteElement.innerText = note;\r\n\r\n        noteContainer.appendChild(noteElement);\r\n\r\n        $column.appendChild(noteContainer);\r\n\r\n        result[note] = noteElement;\r\n      }\r\n\r\n      return result;\r\n  }, {});\r\n\r\n  const highLighted = new Set();\r\n\r\n  function dim(note) {\r\n    if (elements[note]) {\r\n      elements[note].classList.remove(activeClass);\r\n\r\n      highLighted.delete(note);\r\n    }\r\n  }\r\n\r\n  function highLight(note) {\r\n    if (elements[note]) {\r\n      elements[note].classList.add(activeClass);\r\n\r\n      highLighted.add(note);\r\n    }\r\n  }\r\n\r\n  function dimAll() {\r\n    [...highLighted].forEach(dim);\r\n  }\r\n\r\n  return {\r\n    $el,\r\n    highLight,\r\n    dim,\r\n    dimAll\r\n  }\r\n}\r\n\r\n\r\n","/**\r\n * Ion.Sound\r\n * version 3.0.7 Build 89\r\n * © Denis Ineshin, 2016\r\n *\r\n * Project page:    http://ionden.com/a/plugins/ion.sound/en.html\r\n * GitHub page:     https://github.com/IonDen/ion.sound\r\n *\r\n * Released under MIT licence:\r\n * http://ionden.com/a/plugins/licence-en.html\r\n */\r\n\r\n;(function (window, navigator, $, undefined) {\r\n    \"use strict\";\r\n\r\n    window.ion = window.ion || {};\r\n\r\n    if (ion.sound) {\r\n        return;\r\n    }\r\n\r\n    var warn = function (text) {\r\n        if (!text) text = \"undefined\";\r\n\r\n        if (window.console) {\r\n            if (console.warn && typeof console.warn === \"function\") {\r\n                console.warn(text);\r\n            } else if (console.log && typeof console.log === \"function\") {\r\n                console.log(text);\r\n            }\r\n\r\n            var d = $ && $(\"#debug\");\r\n            if (d && d.length) {\r\n                var a = d.html();\r\n                d.html(a + text + '<br/>');\r\n            }\r\n        }\r\n    };\r\n\r\n    var extend = function (parent, child) {\r\n        var prop;\r\n        child = child || {};\r\n\r\n        for (prop in parent) {\r\n            if (parent.hasOwnProperty(prop)) {\r\n                child[prop] = parent[prop];\r\n            }\r\n        }\r\n\r\n        return child;\r\n    };\r\n\r\n\r\n\r\n    /**\r\n     * DISABLE for unsupported browsers\r\n     */\r\n\r\n    if (typeof Audio !== \"function\" && typeof Audio !== \"object\") {\r\n        var func = function () {\r\n            warn(\"HTML5 Audio is not supported in this browser\");\r\n        };\r\n        ion.sound = func;\r\n        ion.sound.play = func;\r\n        ion.sound.stop = func;\r\n        ion.sound.pause = func;\r\n        ion.sound.preload = func;\r\n        ion.sound.destroy = func;\r\n        func();\r\n        return;\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * CORE\r\n     * - creating sounds collection\r\n     * - public methods\r\n     */\r\n\r\n    var is_iOS = /iPad|iPhone|iPod/.test(navigator.appVersion),\r\n        sounds_num = 0,\r\n        settings = {},\r\n        sounds = {},\r\n        i;\r\n\r\n\r\n\r\n    if (!settings.supported && is_iOS) {\r\n        settings.supported = [\"mp3\", \"mp4\", \"aac\"];\r\n    } else if (!settings.supported) {\r\n        settings.supported = [\"mp3\", \"ogg\", \"mp4\", \"aac\", \"wav\"];\r\n    }\r\n\r\n    var createSound = function (obj) {\r\n        var name = obj.alias || obj.name;\r\n\r\n        if (!sounds[name]) {\r\n            sounds[name] = new Sound(obj);\r\n            sounds[name].init();\r\n        }\r\n    };\r\n\r\n    ion.sound = function (options) {\r\n        extend(options, settings);\r\n\r\n        settings.path = settings.path || \"\";\r\n        settings.volume = settings.volume || 1;\r\n        settings.preload = settings.preload || false;\r\n        settings.multiplay = settings.multiplay || false;\r\n        settings.loop = settings.loop || false;\r\n        settings.sprite = settings.sprite || null;\r\n        settings.scope = settings.scope || null;\r\n        settings.ready_callback = settings.ready_callback || null;\r\n        settings.ended_callback = settings.ended_callback || null;\r\n\r\n        sounds_num = settings.sounds.length;\r\n\r\n        if (!sounds_num) {\r\n            warn(\"No sound-files provided!\");\r\n            return;\r\n        }\r\n\r\n        for (i = 0; i < sounds_num; i++) {\r\n            createSound(settings.sounds[i]);\r\n        }\r\n    };\r\n\r\n    ion.sound.VERSION = \"3.0.7\";\r\n\r\n    ion.sound._method = function (method, name, options) {\r\n        if (name) {\r\n            sounds[name] && sounds[name][method](options);\r\n        } else {\r\n            for (i in sounds) {\r\n                if (!sounds.hasOwnProperty(i) || !sounds[i]) {\r\n                    continue;\r\n                }\r\n\r\n                sounds[i][method](options);\r\n            }\r\n        }\r\n    };\r\n\r\n    ion.sound.preload = function (name, options) {\r\n        options = options || {};\r\n        extend({preload: true}, options);\r\n\r\n        ion.sound._method(\"init\", name, options);\r\n    };\r\n\r\n    ion.sound.destroy = function (name) {\r\n        ion.sound._method(\"destroy\", name);\r\n\r\n        if (name) {\r\n            sounds[name] = null;\r\n        } else {\r\n            for (i in sounds) {\r\n                if (!sounds.hasOwnProperty(i)) {\r\n                    continue;\r\n                }\r\n                if (sounds[i]) {\r\n                    sounds[i] = null;\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    ion.sound.play = function (name, options) {\r\n        ion.sound._method(\"play\", name, options);\r\n    };\r\n\r\n    ion.sound.stop = function (name, options) {\r\n        ion.sound._method(\"stop\", name, options);\r\n    };\r\n\r\n    ion.sound.pause = function (name, options) {\r\n        ion.sound._method(\"pause\", name, options);\r\n    };\r\n\r\n    ion.sound.volume = function (name, options) {\r\n        ion.sound._method(\"volume\", name, options);\r\n    };\r\n\r\n    if ($) {\r\n        $.ionSound = ion.sound;\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * Web Audio API core\r\n     * - for most advanced browsers\r\n     */\r\n\r\n    var AudioContext = window.AudioContext || window.webkitAudioContext,\r\n        audio;\r\n\r\n    if (AudioContext) {\r\n        audio = new AudioContext();\r\n    }\r\n\r\n\r\n    var Sound = function (options) {\r\n        this.options = extend(settings);\r\n        delete this.options.sounds;\r\n        extend(options, this.options);\r\n\r\n        this.request = null;\r\n        this.streams = {};\r\n        this.result = {};\r\n        this.ext = 0;\r\n        this.url = \"\";\r\n\r\n        this.loaded = false;\r\n        this.decoded = false;\r\n        this.no_file = false;\r\n        this.autoplay = false;\r\n    };\r\n\r\n    Sound.prototype = {\r\n        init: function (options) {\r\n            if (options) {\r\n                extend(options, this.options);\r\n            }\r\n\r\n            if (this.options.preload) {\r\n                this.load();\r\n            }\r\n        },\r\n\r\n        destroy: function () {\r\n            var stream;\r\n\r\n            for (i in this.streams) {\r\n                stream = this.streams[i];\r\n\r\n                if (stream) {\r\n                    stream.destroy();\r\n                    stream = null;\r\n                }\r\n            }\r\n            this.streams = {};\r\n            this.result = null;\r\n            this.options.buffer = null;\r\n            this.options = null;\r\n\r\n            if (this.request) {\r\n                this.request.removeEventListener(\"load\", this.ready.bind(this), false);\r\n                this.request.removeEventListener(\"error\", this.error.bind(this), false);\r\n                this.request.abort();\r\n                this.request = null;\r\n            }\r\n        },\r\n\r\n        createUrl: function () {\r\n            var no_cache = new Date().valueOf();\r\n            this.url = this.options.path + encodeURIComponent(this.options.name) + \".\" + this.options.supported[this.ext] + \"?\" + no_cache;\r\n        },\r\n\r\n        load: function () {\r\n            if (this.no_file) {\r\n                warn(\"No sources for \\\"\" + this.options.name + \"\\\" sound :(\");\r\n                return;\r\n            }\r\n\r\n            if (this.request) {\r\n                return;\r\n            }\r\n\r\n            this.createUrl();\r\n\r\n            this.request = new XMLHttpRequest();\r\n            this.request.open(\"GET\", this.url, true);\r\n            this.request.responseType = \"arraybuffer\";\r\n            this.request.addEventListener(\"load\", this.ready.bind(this), false);\r\n            this.request.addEventListener(\"error\", this.error.bind(this), false);\r\n\r\n            this.request.send();\r\n        },\r\n\r\n        reload: function () {\r\n            this.ext++;\r\n\r\n            if (this.options.supported[this.ext]) {\r\n                this.load();\r\n            } else {\r\n                this.no_file = true;\r\n                warn(\"No sources for \\\"\" + this.options.name + \"\\\" sound :(\");\r\n            }\r\n        },\r\n\r\n        ready: function (data) {\r\n            this.result = data.target;\r\n\r\n            if (this.result.readyState !== 4) {\r\n                this.reload();\r\n                return;\r\n            }\r\n\r\n            if (this.result.status !== 200 && this.result.status !== 0) {\r\n                warn(this.url + \" was not found on server!\");\r\n                this.reload();\r\n                return;\r\n            }\r\n\r\n            this.request.removeEventListener(\"load\", this.ready.bind(this), false);\r\n            this.request.removeEventListener(\"error\", this.error.bind(this), false);\r\n            this.request = null;\r\n            this.loaded = true;\r\n            //warn(\"Loaded: \" + this.options.name + \".\" + settings.supported[this.ext]);\r\n\r\n            this.decode();\r\n        },\r\n\r\n        decode: function () {\r\n            if (!audio) {\r\n                return;\r\n            }\r\n\r\n            audio.decodeAudioData(this.result.response, this.setBuffer.bind(this), this.error.bind(this));\r\n        },\r\n\r\n        setBuffer: function (buffer) {\r\n            this.options.buffer = buffer;\r\n            this.decoded = true;\r\n            //warn(\"Decoded: \" + this.options.name + \".\" + settings.supported[this.ext]);\r\n\r\n            var config = {\r\n                name: this.options.name,\r\n                alias: this.options.alias,\r\n                ext: this.options.supported[this.ext],\r\n                duration: this.options.buffer.duration\r\n            };\r\n\r\n            if (this.options.ready_callback && typeof this.options.ready_callback === \"function\") {\r\n                this.options.ready_callback.call(this.options.scope, config);\r\n            }\r\n\r\n            if (this.options.sprite) {\r\n\r\n                for (i in this.options.sprite) {\r\n                    this.options.start = this.options.sprite[i][0];\r\n                    this.options.end = this.options.sprite[i][1];\r\n                    this.streams[i] = new Stream(this.options, i);\r\n                }\r\n\r\n            } else {\r\n\r\n                this.streams[0] = new Stream(this.options);\r\n\r\n            }\r\n\r\n            if (this.autoplay) {\r\n                this.autoplay = false;\r\n                this.play();\r\n            }\r\n        },\r\n\r\n        error: function () {\r\n            this.reload();\r\n        },\r\n\r\n        play: function (options) {\r\n            delete this.options.part;\r\n\r\n            if (options) {\r\n                extend(options, this.options);\r\n            }\r\n\r\n            if (!this.loaded) {\r\n                this.autoplay = true;\r\n                this.load();\r\n\r\n                return;\r\n            }\r\n\r\n            if (this.no_file || !this.decoded) {\r\n                return;\r\n            }\r\n\r\n            if (this.options.sprite) {\r\n                if (this.options.part) {\r\n                    this.streams[this.options.part].play(this.options);\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        this.streams[i].play(this.options);\r\n                    }\r\n                }\r\n            } else {\r\n                this.streams[0].play(this.options);\r\n            }\r\n        },\r\n\r\n        stop: function (options) {\r\n            if (this.options.sprite) {\r\n\r\n                if (options) {\r\n                    this.streams[options.part].stop();\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        this.streams[i].stop();\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                this.streams[0].stop();\r\n            }\r\n        },\r\n\r\n        pause: function (options) {\r\n            if (this.options.sprite) {\r\n\r\n                if (options) {\r\n                    this.streams[options.part].pause();\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        this.streams[i].pause();\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                this.streams[0].pause();\r\n            }\r\n        },\r\n\r\n        volume: function (options) {\r\n            var stream;\r\n\r\n            if (options) {\r\n                extend(options, this.options);\r\n            } else {\r\n                return;\r\n            }\r\n\r\n            if (this.options.sprite) {\r\n                if (this.options.part) {\r\n                    stream = this.streams[this.options.part];\r\n                    stream && stream.setVolume(this.options);\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        stream = this.streams[i];\r\n                        stream && stream.setVolume(this.options);\r\n                    }\r\n                }\r\n            } else {\r\n                stream = this.streams[0];\r\n                stream && stream.setVolume(this.options);\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n\r\n    var Stream = function (options, sprite_part) {\r\n        this.alias = options.alias;\r\n        this.name = options.name;\r\n        this.sprite_part = sprite_part;\r\n\r\n        this.buffer = options.buffer;\r\n        this.start = options.start || 0;\r\n        this.end = options.end || this.buffer.duration;\r\n        this.multiplay = options.multiplay || false;\r\n        this.volume = options.volume || 1;\r\n        this.scope = options.scope;\r\n        this.ended_callback = options.ended_callback;\r\n\r\n        this.setLoop(options);\r\n\r\n        this.source = null;\r\n        this.gain = null;\r\n        this.playing = false;\r\n        this.paused = false;\r\n\r\n        this.time_started = 0;\r\n        this.time_ended = 0;\r\n        this.time_played = 0;\r\n        this.time_offset = 0;\r\n    };\r\n\r\n    Stream.prototype = {\r\n        destroy: function () {\r\n            this.stop();\r\n\r\n            this.buffer = null;\r\n            this.source = null;\r\n\r\n            this.gain && this.gain.disconnect();\r\n            this.source && this.source.disconnect();\r\n            this.gain = null;\r\n            this.source = null;\r\n        },\r\n\r\n        setLoop: function (options) {\r\n            if (options.loop === true) {\r\n                this.loop = 9999999;\r\n            } else if (typeof options.loop === \"number\") {\r\n                this.loop = +options.loop - 1;\r\n            } else {\r\n                this.loop = false;\r\n            }\r\n        },\r\n\r\n        update: function (options) {\r\n            this.setLoop(options);\r\n            if (\"volume\" in options) {\r\n                this.volume = options.volume;\r\n            }\r\n        },\r\n\r\n        play: function (options) {\r\n            if (options) {\r\n                this.update(options);\r\n            }\r\n\r\n            if (!this.multiplay && this.playing) {\r\n                return;\r\n            }\r\n\r\n            this.gain = audio.createGain();\r\n            this.source = audio.createBufferSource();\r\n            this.source.buffer = this.buffer;\r\n            this.source.connect(this.gain);\r\n            this.gain.connect(audio.destination);\r\n            this.gain.gain.value = this.volume;\r\n\r\n            this.source.onended = this.ended.bind(this);\r\n\r\n            this._play();\r\n        },\r\n\r\n        _play: function () {\r\n            var start,\r\n                end;\r\n\r\n            if (this.paused) {\r\n                start = this.start + this.time_offset;\r\n                end = this.end - this.time_offset;\r\n            } else {\r\n                start = this.start;\r\n                end = this.end;\r\n            }\r\n\r\n            if (end <= 0) {\r\n                this.clear();\r\n                return;\r\n            }\r\n\r\n            if (typeof this.source.start === \"function\") {\r\n                this.source.start(0, start, end);\r\n            } else {\r\n                this.source.noteOn(0, start, end);\r\n            }\r\n\r\n            this.playing = true;\r\n            this.paused = false;\r\n            this.time_started = new Date().valueOf();\r\n        },\r\n\r\n        stop: function () {\r\n            if (this.playing && this.source) {\r\n                if (typeof this.source.stop === \"function\") {\r\n                    this.source.stop(0);\r\n                } else {\r\n                    this.source.noteOff(0);\r\n                }\r\n            }\r\n\r\n            this.clear();\r\n        },\r\n\r\n        pause: function () {\r\n            if (this.paused) {\r\n                this.play();\r\n                return;\r\n            }\r\n\r\n            if (!this.playing) {\r\n                return;\r\n            }\r\n\r\n            this.source && this.source.stop(0);\r\n            this.paused = true;\r\n        },\r\n\r\n        ended: function () {\r\n            this.playing = false;\r\n            this.time_ended = new Date().valueOf();\r\n            this.time_played = (this.time_ended - this.time_started) / 1000;\r\n            this.time_offset += this.time_played;\r\n\r\n            if (this.time_offset >= this.end || this.end - this.time_offset < 0.015) {\r\n                this._ended();\r\n                this.clear();\r\n\r\n                if (this.loop) {\r\n                    this.loop--;\r\n                    this.play();\r\n                }\r\n            }\r\n        },\r\n\r\n        _ended: function () {\r\n            var config = {\r\n                name: this.name,\r\n                alias: this.alias,\r\n                part: this.sprite_part,\r\n                start: this.start,\r\n                duration: this.end\r\n            };\r\n\r\n            if (this.ended_callback && typeof this.ended_callback === \"function\") {\r\n                this.ended_callback.call(this.scope, config);\r\n            }\r\n        },\r\n\r\n        clear: function () {\r\n            this.time_played = 0;\r\n            this.time_offset = 0;\r\n            this.paused = false;\r\n            this.playing = false;\r\n        },\r\n\r\n        setVolume: function (options) {\r\n            this.volume = options.volume;\r\n\r\n            if (this.gain) {\r\n                this.gain.gain.value = this.volume;\r\n            }\r\n        }\r\n    };\r\n\r\n    if (audio) {\r\n        return;\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * Fallback for HTML5 audio\r\n     * - for not so modern browsers\r\n     */\r\n\r\n    var checkSupport = function () {\r\n        var sound = new Audio(),\r\n            can_play_mp3 = sound.canPlayType('audio/mpeg'),\r\n            can_play_ogg = sound.canPlayType('audio/ogg'),\r\n            can_play_aac = sound.canPlayType('audio/mp4; codecs=\"mp4a.40.2\"'),\r\n            item, i;\r\n\r\n        for (i = 0; i < settings.supported.length; i++) {\r\n            item = settings.supported[i];\r\n\r\n            if (!can_play_mp3 && item === \"mp3\") {\r\n                settings.supported.splice(i, 1);\r\n            }\r\n\r\n            if (!can_play_ogg && item === \"ogg\") {\r\n                settings.supported.splice(i, 1);\r\n            }\r\n\r\n            if (!can_play_aac && item === \"aac\") {\r\n                settings.supported.splice(i, 1);\r\n            }\r\n\r\n            if (!can_play_aac && item === \"mp4\") {\r\n                settings.supported.splice(i, 1);\r\n            }\r\n        }\r\n\r\n        sound = null;\r\n    };\r\n    checkSupport();\r\n\r\n\r\n\r\n    Sound.prototype = {\r\n        init: function (options) {\r\n            if (options) {\r\n                extend(options, this.options);\r\n            }\r\n\r\n            this.inited = true;\r\n\r\n            if (this.options.preload) {\r\n                this.load();\r\n            }\r\n        },\r\n\r\n        destroy: function () {\r\n            var stream;\r\n\r\n            for (i in this.streams) {\r\n                stream = this.streams[i];\r\n\r\n                if (stream) {\r\n                    stream.destroy();\r\n                    stream = null;\r\n                }\r\n            }\r\n            this.streams = {};\r\n            this.loaded = false;\r\n            this.inited = false;\r\n        },\r\n\r\n        load: function () {\r\n            var part;\r\n\r\n            this.options.preload = true;\r\n            this.options._ready = this.ready;\r\n            this.options._scope = this;\r\n\r\n            if (this.options.sprite) {\r\n\r\n                for (i in this.options.sprite) {\r\n                    part = this.options.sprite[i];\r\n\r\n                    this.options.start = part[0];\r\n                    this.options.end = part[1];\r\n\r\n                    this.streams[i] = new Stream(this.options, i);\r\n                }\r\n\r\n            } else {\r\n\r\n                this.streams[0] = new Stream(this.options);\r\n\r\n            }\r\n        },\r\n\r\n        ready: function (duration) {\r\n            if (this.loaded) {\r\n                return;\r\n            }\r\n\r\n            this.loaded = true;\r\n\r\n            var config = {\r\n                name: this.options.name,\r\n                alias: this.options.alias,\r\n                ext: this.options.supported[this.ext],\r\n                duration: duration\r\n            };\r\n\r\n            if (this.options.ready_callback && typeof this.options.ready_callback === \"function\") {\r\n                this.options.ready_callback.call(this.options.scope, config);\r\n            }\r\n\r\n            if (this.autoplay) {\r\n                this.autoplay = false;\r\n                this.play();\r\n            }\r\n        },\r\n\r\n        play: function (options) {\r\n            if (!this.inited) {\r\n                return;\r\n            }\r\n\r\n            delete this.options.part;\r\n\r\n            if (options) {\r\n                extend(options, this.options);\r\n            }\r\n\r\n            console.log(1);\r\n            if (!this.loaded) {\r\n                if (!this.options.preload) {\r\n                    this.autoplay = true;\r\n                    this.load();\r\n                } else {\r\n                    this.autoplay = true;\r\n                }\r\n\r\n                return;\r\n            }\r\n\r\n            if (this.options.sprite) {\r\n                if (this.options.part) {\r\n                    this.streams[this.options.part].play(this.options);\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        this.streams[i].play(this.options);\r\n                    }\r\n                }\r\n            } else {\r\n                this.streams[0].play(this.options);\r\n            }\r\n        },\r\n\r\n        stop: function (options) {\r\n            if (!this.inited) {\r\n                return;\r\n            }\r\n\r\n            if (this.options.sprite) {\r\n\r\n                if (options) {\r\n                    this.streams[options.part].stop();\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        this.streams[i].stop();\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                this.streams[0].stop();\r\n            }\r\n        },\r\n\r\n        pause: function (options) {\r\n            if (!this.inited) {\r\n                return;\r\n            }\r\n\r\n            if (this.options.sprite) {\r\n\r\n                if (options) {\r\n                    this.streams[options.part].pause();\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        this.streams[i].pause();\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                this.streams[0].pause();\r\n            }\r\n        },\r\n\r\n        volume: function (options) {\r\n            var stream;\r\n\r\n            if (options) {\r\n                extend(options, this.options);\r\n            } else {\r\n                return;\r\n            }\r\n\r\n            if (this.options.sprite) {\r\n                if (this.options.part) {\r\n                    stream = this.streams[this.options.part];\r\n                    stream && stream.setVolume(this.options);\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        stream = this.streams[i];\r\n                        stream && stream.setVolume(this.options);\r\n                    }\r\n                }\r\n            } else {\r\n                stream = this.streams[0];\r\n                stream && stream.setVolume(this.options);\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n\r\n    Stream = function (options, sprite_part) {\r\n        this.name = options.name;\r\n        this.alias = options.alias;\r\n        this.sprite_part = sprite_part;\r\n\r\n        this.multiplay = options.multiplay;\r\n        this.volume = options.volume;\r\n        this.preload = options.preload;\r\n        this.path = settings.path;\r\n        this.start = options.start || 0;\r\n        this.end = options.end || 0;\r\n        this.scope = options.scope;\r\n        this.ended_callback = options.ended_callback;\r\n\r\n        this._scope = options._scope;\r\n        this._ready = options._ready;\r\n\r\n        this.setLoop(options);\r\n\r\n        this.sound = null;\r\n        this.url = null;\r\n        this.loaded = false;\r\n\r\n        this.start_time = 0;\r\n        this.paused_time = 0;\r\n        this.played_time = 0;\r\n\r\n        this.init();\r\n    };\r\n\r\n    Stream.prototype = {\r\n        init: function () {\r\n            this.sound = new Audio();\r\n            this.sound.volume = this.volume;\r\n\r\n            this.createUrl();\r\n\r\n            this.sound.addEventListener(\"ended\", this.ended.bind(this), false);\r\n            this.sound.addEventListener(\"canplaythrough\", this.can_play_through.bind(this), false);\r\n            this.sound.addEventListener(\"timeupdate\", this._update.bind(this), false);\r\n\r\n            this.load();\r\n        },\r\n\r\n        destroy: function () {\r\n            this.stop();\r\n\r\n            this.sound.removeEventListener(\"ended\", this.ended.bind(this), false);\r\n            this.sound.removeEventListener(\"canplaythrough\", this.can_play_through.bind(this), false);\r\n            this.sound.removeEventListener(\"timeupdate\", this._update.bind(this), false);\r\n\r\n            this.sound = null;\r\n            this.loaded = false;\r\n        },\r\n\r\n        createUrl: function () {\r\n            var rand = new Date().valueOf();\r\n            this.url = this.path + encodeURIComponent(this.name) + \".\" + settings.supported[0] + \"?\" + rand;\r\n        },\r\n\r\n        can_play_through: function () {\r\n            if (this.preload) {\r\n                this.ready();\r\n            }\r\n        },\r\n\r\n        load: function () {\r\n            this.sound.src = this.url;\r\n            this.sound.preload = this.preload ? \"auto\" : \"none\";\r\n            if (this.preload) {\r\n                this.sound.load();\r\n            }\r\n        },\r\n\r\n        setLoop: function (options) {\r\n            if (options.loop === true) {\r\n                this.loop = 9999999;\r\n            } else if (typeof options.loop === \"number\") {\r\n                this.loop = +options.loop - 1;\r\n            } else {\r\n                this.loop = false;\r\n            }\r\n        },\r\n\r\n        update: function (options) {\r\n            this.setLoop(options);\r\n\r\n            if (\"volume\" in options) {\r\n                this.volume = options.volume;\r\n            }\r\n        },\r\n\r\n        ready: function () {\r\n            if (this.loaded || !this.sound) {\r\n                return;\r\n            }\r\n\r\n            this.loaded = true;\r\n            this._ready.call(this._scope, this.sound.duration);\r\n\r\n            if (!this.end) {\r\n                this.end = this.sound.duration;\r\n            }\r\n        },\r\n\r\n        play: function (options) {\r\n            if (options) {\r\n                this.update(options);\r\n            }\r\n\r\n            if (!this.multiplay && this.playing) {\r\n                return;\r\n            }\r\n\r\n            this._play();\r\n        },\r\n\r\n        _play: function () {\r\n            if (this.paused) {\r\n                this.paused = false;\r\n            } else {\r\n                try {\r\n                    this.sound.currentTime = this.start;\r\n                } catch (e) {}\r\n            }\r\n\r\n            this.playing = true;\r\n            this.start_time = new Date().valueOf();\r\n            this.sound.volume = this.volume;\r\n            this.sound.play();\r\n        },\r\n\r\n        stop: function () {\r\n            if (!this.playing) {\r\n                return;\r\n            }\r\n\r\n            this.playing = false;\r\n            this.paused = false;\r\n            this.sound.pause();\r\n            this.clear();\r\n\r\n            try {\r\n                this.sound.currentTime = this.start;\r\n            } catch (e) {}\r\n        },\r\n\r\n        pause: function () {\r\n            if (this.paused) {\r\n                this._play();\r\n            } else {\r\n                this.playing = false;\r\n                this.paused = true;\r\n                this.sound.pause();\r\n                this.paused_time = new Date().valueOf();\r\n                this.played_time += this.paused_time - this.start_time;\r\n            }\r\n        },\r\n\r\n        _update: function () {\r\n            if (!this.start_time) {\r\n                return;\r\n            }\r\n\r\n            var current_time = new Date().valueOf(),\r\n                played_time = current_time - this.start_time,\r\n                played = (this.played_time + played_time) / 1000;\r\n\r\n            if (played >= this.end) {\r\n                if (this.playing) {\r\n                    this.stop();\r\n                    this._ended();\r\n                }\r\n            }\r\n        },\r\n\r\n        ended: function () {\r\n            if (this.playing) {\r\n                this.stop();\r\n                this._ended();\r\n            }\r\n        },\r\n\r\n        _ended: function () {\r\n            this.playing = false;\r\n\r\n            var config = {\r\n                name: this.name,\r\n                alias: this.alias,\r\n                part: this.sprite_part,\r\n                start: this.start,\r\n                duration: this.end\r\n            };\r\n\r\n            if (this.ended_callback && typeof this.ended_callback === \"function\") {\r\n                this.ended_callback.call(this.scope, config);\r\n            }\r\n\r\n            if (this.loop) {\r\n                setTimeout(this.looper.bind(this), 15);\r\n            }\r\n        },\r\n\r\n        looper: function () {\r\n            this.loop--;\r\n            this.play();\r\n        },\r\n\r\n        clear: function () {\r\n            this.start_time = 0;\r\n            this.played_time = 0;\r\n            this.paused_time = 0;\r\n        },\r\n\r\n        setVolume: function (options) {\r\n            this.volume = options.volume;\r\n\r\n            if (this.sound) {\r\n                this.sound.volume = this.volume;\r\n            }\r\n        }\r\n    };\r\n\r\n} (window, navigator, window.jQuery || window.$));\r\n","import './vendor/ion.sound';\r\n\r\nconst NOTES = {\r\n  SNAP: 'snap',\r\n\r\n  \"F,,\": 'F0',\r\n\r\n  \"C,\": 'C1',\r\n  \"D,\": 'D1',\r\n  \"E,\": 'E1',\r\n  \"F,\": 'F1',\r\n  \"G,\": 'G1',\r\n  \"A,\": 'A1',\r\n  \"B,\": 'B1',\r\n\r\n  C: 'C2',\r\n  D: 'D2',\r\n  E: 'E2',\r\n  F: 'F2',\r\n  G: 'G2',\r\n  A: 'A2',\r\n  B: 'B2',\r\n\r\n  c: 'C3',\r\n  d: 'D3',\r\n  e: 'E3',\r\n  f: 'F3',\r\n  g: 'G3',\r\n  a: 'A3',\r\n};\r\n\r\nconst Player = (function () {\r\n  let instance;\r\n\r\n  function GlobalPlayer({soundFolder = 'sounds/'} = {}) {\r\n    const ion = window.ion;\r\n\r\n    ion.sound({\r\n      sounds: Object.values(NOTES).map(name => ({\r\n        name,\r\n        volume: name === NOTES.SNAP\r\n          ? 1.0\r\n          : 0.3\r\n      })),\r\n      path: soundFolder,\r\n      preload: true,\r\n      multiplay: true\r\n    });\r\n\r\n    return {\r\n      playNote: (note) => {\r\n        if (NOTES[note]) {\r\n          ion.sound.play(NOTES[note]);\r\n        }\r\n      },\r\n      playSnap: () => {\r\n        ion.sound.play(NOTES.SNAP);\r\n      },\r\n    }\r\n  }\r\n\r\n  return function({soundFolder} = {}) {\r\n    if (!instance) {\r\n      instance = new GlobalPlayer({soundFolder});\r\n    }\r\n\r\n    return instance;\r\n  }\r\n}());\r\n\r\nexport default Player;\r\n","export default function noop() {}\r\n","const second = 1000;\r\nconst minute = second * 60;\r\nimport noop from \"./helpers/noop\";\r\n\r\nexport default function Ticker({\r\n  ticksPerMinute = 60,\r\n  onTick = noop\r\n} = {}) {\r\n  let tpm = ticksPerMinute;\r\n  let interval;\r\n\r\n  function stop() {\r\n    clearInterval(interval);\r\n\r\n    interval = null;\r\n  }\r\n\r\n  function start() {\r\n    stop();\r\n\r\n    interval = setInterval(onTick, minute / tpm);\r\n  }\r\n\r\n  function update({ticksPerMinute}) {\r\n    tpm = ticksPerMinute;\r\n\r\n    if (interval) {\r\n      start();\r\n    }\r\n  }\r\n\r\n  return {\r\n    start,\r\n    stop,\r\n    update\r\n  }\r\n}\r\n","import noop from \"./helpers/noop\";\r\nimport createElement from \"./helpers/createElement\";\r\nimport __ from \"./helpers/translate\";\r\n\r\nexport default function ControllerView({\r\n  onPlay = noop,\r\n  onStop = noop,\r\n  onClickSlower = noop,\r\n  onClickFaster = noop,\r\n  viewerElement,\r\n  block = 'harp-view',\r\n  bpm\r\n} = {}) {\r\n  const state = {\r\n    playing: false,\r\n    bpm\r\n  };\r\n\r\n  const $el = createElement('div', block);\r\n  const playButton = createElement('button', `${block}__play`, {\r\n    click: function() {\r\n      if (!state.playing) {\r\n        onPlay();\r\n      } else {\r\n        onStop();\r\n      }\r\n    }\r\n  });\r\n\r\n  function updateButton() {\r\n    playButton.innerText = __(!state.playing ? 'play' : 'stop');\r\n  }\r\n\r\n  updateButton();\r\n\r\n  const controlSpeed = createElement('span', `${block}__control-speed`);\r\n  Object.assign(controlSpeed.style, {\r\n    display: 'inline-block',\r\n    margin: '0 1em'\r\n  });\r\n\r\n  const slowerBtn = createElement('button', `${block}__speed-button`, {\r\n    click: onClickSlower\r\n  });\r\n  slowerBtn.innerText = __('slower');\r\n\r\n  const fasterBtn = createElement('button', `${block}__speed-button`, {\r\n    click: onClickFaster\r\n  });\r\n  fasterBtn.innerText = __('faster');\r\n\r\n  const bpmElement = createElement('span', `${block}__bpm`);\r\n  Object.assign(bpmElement.style, {\r\n    display: 'inline-block',\r\n    margin: '0 0.5em'\r\n  });\r\n\r\n  function updateBpm() {\r\n    bpmElement.innerText = state.bpm || '';\r\n  }\r\n\r\n  controlSpeed.appendChild(slowerBtn);\r\n  controlSpeed.appendChild(bpmElement);\r\n  controlSpeed.appendChild(fasterBtn);\r\n\r\n  updateBpm();\r\n\r\n  $el.appendChild(playButton);\r\n  $el.appendChild(controlSpeed);\r\n\r\n  const viewerContainer = createElement('div', `${block}__viewer`);\r\n  Object.assign(viewerContainer.style, {\r\n    maxWidth: '320px',\r\n    margin: '0 auto'\r\n  });\r\n\r\n  viewerContainer.appendChild(viewerElement);\r\n  $el.appendChild(viewerContainer);\r\n\r\n  const updateElement = {\r\n    playing: updateButton,\r\n    bpm: updateBpm\r\n  };\r\n\r\n  function update(newState) {\r\n    Object.entries(newState).forEach(([key, value]) => {\r\n      if (state[key] !== value) {\r\n        state[key] = value;\r\n\r\n        updateElement[key]();\r\n      }\r\n    });\r\n  }\r\n\r\n  return {\r\n    $el,\r\n    update\r\n  }\r\n}\r\n","const PAUSES = new Set(['x', 'z']);\r\n\r\nconst isPause = note => PAUSES.has(note);\r\n\r\nexport default isPause;\r\n","import Viewer from './viewer';\r\nimport Player from './player';\r\nimport Ticker from './ticker';\r\nimport ControllerView from \"./controller-view\";\r\nimport isPause from './helpers/isPause';\r\n\r\nexport default function Controller({tune, soundFolder}) {\r\n  let tick = -1;\r\n  let tuneIndex = -1;\r\n  let ticksPerMinute = 120 * 4;\r\n\r\n  const ticksPerMinuteSteps = [0.2, 0.4, 0.6, 0.8, 1, 1.2, 1.4, 1.6, 1.8, 2, 2.5, 3, 3.5, 4]\r\n    .map(multiplier => Math.round(ticksPerMinute * multiplier));\r\n\r\n  let currentTicksStep = ticksPerMinuteSteps.findIndex(tpm => tpm === ticksPerMinute);\r\n\r\n  const modifiers = ['\\'', ','];\r\n\r\n  const tuneArray = tune\r\n    .split('')\r\n    .reduce((result, symbol) => {\r\n      let note = modifiers.includes(symbol)\r\n        ? result.pop() + symbol\r\n        : symbol;\r\n\r\n      result.push(note);\r\n\r\n      return result;\r\n    }, []);\r\n  const ticksPerSnap = 4;\r\n  const ticksPerNote = 2;\r\n  const highLightTicks = 1;\r\n\r\n  const viewer = new Viewer();\r\n  const player = new Player({soundFolder});\r\n\r\n  const playAndShow = () => {\r\n    const note = tuneArray[tuneIndex];\r\n\r\n    viewer.dimAll();\r\n\r\n    if (isPause(note)) {\r\n      return;\r\n    }\r\n\r\n    player.playNote(note);\r\n    viewer.highLight(note);\r\n  };\r\n\r\n  let ticker;\r\n  let controllerView;\r\n\r\n  const stop = () => {\r\n    tick = -1;\r\n    tuneIndex = -1;\r\n\r\n    controllerView.update({playing: false});\r\n    ticker.stop();\r\n    viewer.dimAll();\r\n  };\r\n\r\n  const onTick = () => {\r\n    tick += 1;\r\n\r\n    if (tick % ticksPerNote === highLightTicks) {\r\n      viewer.dimAll();\r\n    }\r\n\r\n    if (tick % ticksPerNote === 0) {\r\n      tuneIndex += 1;\r\n\r\n      if (tuneIndex === tuneArray.length) {\r\n        return stop();\r\n      }\r\n\r\n      playAndShow();\r\n    }\r\n\r\n    if (tick % ticksPerSnap === 0) {\r\n      player.playSnap();\r\n    }\r\n  };\r\n\r\n  ticker = new Ticker({\r\n    ticksPerMinute,\r\n    onTick\r\n  });\r\n\r\n  const speedStep = (increment) => {\r\n    currentTicksStep = Math.max(0, Math.min((currentTicksStep + increment), ticksPerMinuteSteps.length - 1));\r\n\r\n    ticksPerMinute = ticksPerMinuteSteps[currentTicksStep];\r\n\r\n    ticker.update({ticksPerMinute});\r\n    controllerView.update({bpm: ticksPerMinute / ticksPerSnap});\r\n  };\r\n\r\n  controllerView = new ControllerView({\r\n    viewerElement: viewer.$el,\r\n\r\n    bpm: ticksPerMinute / ticksPerSnap,\r\n\r\n    onClickFaster() {\r\n      speedStep(+1);\r\n    },\r\n\r\n    onClickSlower() {\r\n      speedStep(-1);\r\n    },\r\n\r\n    onPlay() {\r\n      controllerView.update({playing: true});\r\n\r\n      ticker.start();\r\n    },\r\n    onStop: stop\r\n  });\r\n\r\n  return controllerView.$el;\r\n}\r\n","import insertAfter from './helpers/insertAfter';\r\nimport __ from './helpers/translate';\r\nimport tuneValid from './helpers/tuneValid';\r\nimport Controller from \"./controller\";\r\n\r\nwindow.HarpView = function(selector, soundFolder) {\r\n  document.querySelectorAll('.' + selector).forEach(node => {\r\n    const tune = node.innerHTML.trim();\r\n\r\n    if (!tuneValid(tune)) {\r\n      console.error(__('error.bad-tune'), node);\r\n\r\n      return;\r\n    }\r\n\r\n    insertAfter(new Controller({tune, soundFolder}), node);\r\n  });\r\n};\r\n"]}
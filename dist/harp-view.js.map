{"version":3,"sources":["helpers/insertAfter.js","helpers/translate.js","helpers/tuneValid.js","helpers/createElement.js","viewer/index.js","vendor/ion.sound.js","player.js","helpers/noop.js","ticker.js","controller-view.js","helpers/isPause.js","controller.js","harp-view.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["insertAfter","newNode","referenceNode","parentNode","insertBefore","nextSibling","translations","lang","translate","key","tuneValid","tune","Boolean","createElement","name","classes","listeners","element","document","classesArray","classList","add","Object","keys","forEach","event","addEventListener","styles","styleAdded","addStyles","style","innerHTML","head","appendChild","getNoteModifier","note","replace","baseContainerClass","baseNoteClass","activeClass","Viewer","notes","$el","$column","elements","split","reduce","result","index","arr","length","noteContainer","noteElement","innerText","highLighted","Set","dim","remove","delete","highLight","dimAll","window","navigator","$","undefined","ion","sound","warn","text","console","log","d","a","html","extend","parent","child","prop","hasOwnProperty","Audio","func","play","stop","pause","preload","destroy","is_iOS","test","appVersion","sounds_num","settings","sounds","i","supported","createSound","obj","alias","Sound","init","options","path","volume","multiplay","loop","sprite","scope","ready_callback","ended_callback","VERSION","_method","method","ionSound","AudioContext","webkitAudioContext","audio","request","streams","ext","url","loaded","decoded","no_file","autoplay","prototype","load","stream","buffer","removeEventListener","ready","bind","error","abort","createUrl","no_cache","Date","valueOf","encodeURIComponent","XMLHttpRequest","open","responseType","send","reload","data","target","readyState","status","decode","decodeAudioData","response","setBuffer","config","duration","call","start","end","Stream","part","setVolume","sprite_part","setLoop","source","gain","playing","paused","time_started","time_ended","time_played","time_offset","disconnect","update","createGain","createBufferSource","connect","destination","value","onended","ended","_play","clear","noteOn","noteOff","_ended","checkSupport","can_play_mp3","canPlayType","can_play_ogg","can_play_aac","item","splice","inited","_ready","_scope","start_time","paused_time","played_time","can_play_through","_update","rand","src","currentTime","e","current_time","played","setTimeout","looper","jQuery","NOTES","SNAP","K","A","B","C","D","E","F","G","c","f","g","b","Player","instance","GlobalPlayer","values","map","playNote","playSnap","noop","second","minute","Ticker","ticksPerMinute","onTick","tpm","interval","clearInterval","setInterval","ControllerView","onPlay","onStop","onClickSlower","onClickFaster","viewerElement","block","bpm","state","playButton","click","updateButton","controlSpeed","assign","display","margin","slowerBtn","fasterBtn","bpmElement","updateBpm","viewerContainer","maxWidth","updateElement","newState","entries","PAUSES","isPause","has","Controller","tick","tuneIndex","ticksPerMinuteSteps","multiplier","Math","round","currentTicksStep","findIndex","modifiers","tuneArray","symbol","includes","pop","push","ticksPerSnap","ticksPerNote","highLightTicks","viewer","player","playAndShow","ticker","controllerView","speedStep","increment","max","min","HarpView","selector","querySelectorAll","node","trim","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","JSON","parse","type","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","hmrApply","v","hmrAcceptRun","close","onclose","removeErrorOverlay","message","stack","overlay","createErrorOverlay","body","getElementById","stackTrace","getParents","modules","parents","k","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"harp-view.js","sourceRoot":"..\\src","sourcesContent":["/**\r\n * insertAfter helper\r\n *\r\n * @param {Element} newNode\r\n * @param {Element} referenceNode\r\n */\r\nexport default function insertAfter(newNode, referenceNode) {\r\n  referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\r\n}\r\n","const translations = {\r\n  'en': {\r\n    'error.bad-tune': \"Empty tune or unknown format\",\r\n    'play': 'Play',\r\n    'pause': 'Pause',\r\n    'stop': 'Stop'\r\n  },\r\n\r\n  'ru': {\r\n    'error.bad-tune': 'Пустая мелодия или ошибка в записи',\r\n    'play': 'Играть',\r\n    'pause': 'Пауза',\r\n    'stop': 'Остановить'\r\n  }\r\n};\r\n\r\nconst lang = 'en';\r\n\r\n/**\r\n * Translate by key\r\n *\r\n * @param key\r\n * @returns {string}\r\n */\r\nconst translate = key =>\r\n  translations\r\n  && translations[lang]\r\n  && translations[lang][key]\r\n  || key;\r\n\r\nexport default translate;\r\n","/**\r\n * Validates tune\r\n *  - not empty\r\n *  @TODO: conforms to chosen standard (e.g. abc)\r\n *\r\n * @param {string} tune\r\n * @returns {boolean}\r\n */\r\nexport default function tuneValid(tune) {\r\n  return Boolean(tune);\r\n}\r\n","/**\r\n * Creates element with class and listeners\r\n *\r\n * @param {string} name\r\n * @param {string|array} [classes=[]]\r\n * @param {object} [listeners={}]\r\n * @returns {Element}\r\n */\r\nexport default function createElement(name, classes = [], listeners = {}) {\r\n  const element = document.createElement(name);\r\n  const classesArray = typeof classes === 'string'\r\n    ? [classes]\r\n    : classes;\r\n\r\n  element.classList.add(...classesArray);\r\n\r\n  Object.keys(listeners).forEach(event => {\r\n    element.addEventListener(event, listeners[event]);\r\n  });\r\n\r\n  return element;\r\n}\r\n","import createElement from \"../helpers/createElement\";\r\n\r\nimport fs from 'fs';\r\nconst styles = fs.readFileSync(__dirname + '/notes-viewer.css', 'utf8');\r\n\r\nlet styleAdded = false;\r\n\r\nconst addStyles = () => {\r\n  if (styleAdded) {\r\n    return;\r\n  }\r\n\r\n  const style = document.createElement('style');\r\n\r\n  style.innerHTML = styles;\r\n\r\n  document.head.appendChild(style);\r\n\r\n  styleAdded = true;\r\n};\r\n\r\nconst getNoteModifier = note => note\r\n  .replace('\\'', '-high')\r\n  .replace(',', '-low');\r\n\r\nconst baseContainerClass = 'notes-viewer__container';\r\nconst baseNoteClass = 'notes-viewer__note';\r\nconst activeClass = `${baseNoteClass}_active`;\r\n\r\nexport default function Viewer() {\r\n  // const notes = \"F, C, D, E, F G A B c d e f | g a b c' d' e' f' g' a' x\";\r\n\r\n  const notes = \"| e c a f D B G E, D, C, F, | a' g' f' d b g E C A F x |\";\r\n\r\n  const $el = createElement('div', 'notes-viewer');\r\n\r\n  addStyles();\r\n\r\n  let $column;\r\n\r\n  const elements = notes\r\n    .split(' ')\r\n    .reduce((result, note, index, arr) => {\r\n      if (note === '|') {\r\n        if ($column) {\r\n          $el.appendChild($column);\r\n        }\r\n\r\n        if (index !== arr.length - 1) {\r\n          $column = createElement('ul', 'notes-viewer__column');\r\n        }\r\n      } else {\r\n        const noteContainer = createElement('li', [\r\n          baseContainerClass,\r\n          `${baseContainerClass}_${getNoteModifier(note)}`\r\n        ]);\r\n\r\n        const noteElement = createElement('span', baseNoteClass);\r\n        noteElement.innerText = note;\r\n\r\n        noteContainer.appendChild(noteElement);\r\n\r\n        $column.appendChild(noteContainer);\r\n\r\n        result[note] = noteElement;\r\n      }\r\n\r\n      return result;\r\n  }, {});\r\n\r\n  const highLighted = new Set();\r\n\r\n  function dim(note) {\r\n    if (elements[note]) {\r\n      elements[note].classList.remove(activeClass);\r\n\r\n      highLighted.delete(note);\r\n    }\r\n  }\r\n\r\n  function highLight(note) {\r\n    if (elements[note]) {\r\n      elements[note].classList.add(activeClass);\r\n\r\n      highLighted.add(note);\r\n    }\r\n  }\r\n\r\n  function dimAll() {\r\n    [...highLighted].forEach(dim);\r\n  }\r\n\r\n  return {\r\n    $el,\r\n    highLight,\r\n    dim,\r\n    dimAll\r\n  }\r\n}\r\n\r\n\r\n","/**\r\n * Ion.Sound\r\n * version 3.0.7 Build 89\r\n * © Denis Ineshin, 2016\r\n *\r\n * Project page:    http://ionden.com/a/plugins/ion.sound/en.html\r\n * GitHub page:     https://github.com/IonDen/ion.sound\r\n *\r\n * Released under MIT licence:\r\n * http://ionden.com/a/plugins/licence-en.html\r\n */\r\n\r\n;(function (window, navigator, $, undefined) {\r\n    \"use strict\";\r\n\r\n    window.ion = window.ion || {};\r\n\r\n    if (ion.sound) {\r\n        return;\r\n    }\r\n\r\n    var warn = function (text) {\r\n        if (!text) text = \"undefined\";\r\n\r\n        if (window.console) {\r\n            if (console.warn && typeof console.warn === \"function\") {\r\n                console.warn(text);\r\n            } else if (console.log && typeof console.log === \"function\") {\r\n                console.log(text);\r\n            }\r\n\r\n            var d = $ && $(\"#debug\");\r\n            if (d && d.length) {\r\n                var a = d.html();\r\n                d.html(a + text + '<br/>');\r\n            }\r\n        }\r\n    };\r\n\r\n    var extend = function (parent, child) {\r\n        var prop;\r\n        child = child || {};\r\n\r\n        for (prop in parent) {\r\n            if (parent.hasOwnProperty(prop)) {\r\n                child[prop] = parent[prop];\r\n            }\r\n        }\r\n\r\n        return child;\r\n    };\r\n\r\n\r\n\r\n    /**\r\n     * DISABLE for unsupported browsers\r\n     */\r\n\r\n    if (typeof Audio !== \"function\" && typeof Audio !== \"object\") {\r\n        var func = function () {\r\n            warn(\"HTML5 Audio is not supported in this browser\");\r\n        };\r\n        ion.sound = func;\r\n        ion.sound.play = func;\r\n        ion.sound.stop = func;\r\n        ion.sound.pause = func;\r\n        ion.sound.preload = func;\r\n        ion.sound.destroy = func;\r\n        func();\r\n        return;\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * CORE\r\n     * - creating sounds collection\r\n     * - public methods\r\n     */\r\n\r\n    var is_iOS = /iPad|iPhone|iPod/.test(navigator.appVersion),\r\n        sounds_num = 0,\r\n        settings = {},\r\n        sounds = {},\r\n        i;\r\n\r\n\r\n\r\n    if (!settings.supported && is_iOS) {\r\n        settings.supported = [\"mp3\", \"mp4\", \"aac\"];\r\n    } else if (!settings.supported) {\r\n        settings.supported = [\"mp3\", \"ogg\", \"mp4\", \"aac\", \"wav\"];\r\n    }\r\n\r\n    var createSound = function (obj) {\r\n        var name = obj.alias || obj.name;\r\n\r\n        if (!sounds[name]) {\r\n            sounds[name] = new Sound(obj);\r\n            sounds[name].init();\r\n        }\r\n    };\r\n\r\n    ion.sound = function (options) {\r\n        extend(options, settings);\r\n\r\n        settings.path = settings.path || \"\";\r\n        settings.volume = settings.volume || 1;\r\n        settings.preload = settings.preload || false;\r\n        settings.multiplay = settings.multiplay || false;\r\n        settings.loop = settings.loop || false;\r\n        settings.sprite = settings.sprite || null;\r\n        settings.scope = settings.scope || null;\r\n        settings.ready_callback = settings.ready_callback || null;\r\n        settings.ended_callback = settings.ended_callback || null;\r\n\r\n        sounds_num = settings.sounds.length;\r\n\r\n        if (!sounds_num) {\r\n            warn(\"No sound-files provided!\");\r\n            return;\r\n        }\r\n\r\n        for (i = 0; i < sounds_num; i++) {\r\n            createSound(settings.sounds[i]);\r\n        }\r\n    };\r\n\r\n    ion.sound.VERSION = \"3.0.7\";\r\n\r\n    ion.sound._method = function (method, name, options) {\r\n        if (name) {\r\n            sounds[name] && sounds[name][method](options);\r\n        } else {\r\n            for (i in sounds) {\r\n                if (!sounds.hasOwnProperty(i) || !sounds[i]) {\r\n                    continue;\r\n                }\r\n\r\n                sounds[i][method](options);\r\n            }\r\n        }\r\n    };\r\n\r\n    ion.sound.preload = function (name, options) {\r\n        options = options || {};\r\n        extend({preload: true}, options);\r\n\r\n        ion.sound._method(\"init\", name, options);\r\n    };\r\n\r\n    ion.sound.destroy = function (name) {\r\n        ion.sound._method(\"destroy\", name);\r\n\r\n        if (name) {\r\n            sounds[name] = null;\r\n        } else {\r\n            for (i in sounds) {\r\n                if (!sounds.hasOwnProperty(i)) {\r\n                    continue;\r\n                }\r\n                if (sounds[i]) {\r\n                    sounds[i] = null;\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    ion.sound.play = function (name, options) {\r\n        ion.sound._method(\"play\", name, options);\r\n    };\r\n\r\n    ion.sound.stop = function (name, options) {\r\n        ion.sound._method(\"stop\", name, options);\r\n    };\r\n\r\n    ion.sound.pause = function (name, options) {\r\n        ion.sound._method(\"pause\", name, options);\r\n    };\r\n\r\n    ion.sound.volume = function (name, options) {\r\n        ion.sound._method(\"volume\", name, options);\r\n    };\r\n\r\n    if ($) {\r\n        $.ionSound = ion.sound;\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * Web Audio API core\r\n     * - for most advanced browsers\r\n     */\r\n\r\n    var AudioContext = window.AudioContext || window.webkitAudioContext,\r\n        audio;\r\n\r\n    if (AudioContext) {\r\n        audio = new AudioContext();\r\n    }\r\n\r\n\r\n    var Sound = function (options) {\r\n        this.options = extend(settings);\r\n        delete this.options.sounds;\r\n        extend(options, this.options);\r\n\r\n        this.request = null;\r\n        this.streams = {};\r\n        this.result = {};\r\n        this.ext = 0;\r\n        this.url = \"\";\r\n\r\n        this.loaded = false;\r\n        this.decoded = false;\r\n        this.no_file = false;\r\n        this.autoplay = false;\r\n    };\r\n\r\n    Sound.prototype = {\r\n        init: function (options) {\r\n            if (options) {\r\n                extend(options, this.options);\r\n            }\r\n\r\n            if (this.options.preload) {\r\n                this.load();\r\n            }\r\n        },\r\n\r\n        destroy: function () {\r\n            var stream;\r\n\r\n            for (i in this.streams) {\r\n                stream = this.streams[i];\r\n\r\n                if (stream) {\r\n                    stream.destroy();\r\n                    stream = null;\r\n                }\r\n            }\r\n            this.streams = {};\r\n            this.result = null;\r\n            this.options.buffer = null;\r\n            this.options = null;\r\n\r\n            if (this.request) {\r\n                this.request.removeEventListener(\"load\", this.ready.bind(this), false);\r\n                this.request.removeEventListener(\"error\", this.error.bind(this), false);\r\n                this.request.abort();\r\n                this.request = null;\r\n            }\r\n        },\r\n\r\n        createUrl: function () {\r\n            var no_cache = new Date().valueOf();\r\n            this.url = this.options.path + encodeURIComponent(this.options.name) + \".\" + this.options.supported[this.ext] + \"?\" + no_cache;\r\n        },\r\n\r\n        load: function () {\r\n            if (this.no_file) {\r\n                warn(\"No sources for \\\"\" + this.options.name + \"\\\" sound :(\");\r\n                return;\r\n            }\r\n\r\n            if (this.request) {\r\n                return;\r\n            }\r\n\r\n            this.createUrl();\r\n\r\n            this.request = new XMLHttpRequest();\r\n            this.request.open(\"GET\", this.url, true);\r\n            this.request.responseType = \"arraybuffer\";\r\n            this.request.addEventListener(\"load\", this.ready.bind(this), false);\r\n            this.request.addEventListener(\"error\", this.error.bind(this), false);\r\n\r\n            this.request.send();\r\n        },\r\n\r\n        reload: function () {\r\n            this.ext++;\r\n\r\n            if (this.options.supported[this.ext]) {\r\n                this.load();\r\n            } else {\r\n                this.no_file = true;\r\n                warn(\"No sources for \\\"\" + this.options.name + \"\\\" sound :(\");\r\n            }\r\n        },\r\n\r\n        ready: function (data) {\r\n            this.result = data.target;\r\n\r\n            if (this.result.readyState !== 4) {\r\n                this.reload();\r\n                return;\r\n            }\r\n\r\n            if (this.result.status !== 200 && this.result.status !== 0) {\r\n                warn(this.url + \" was not found on server!\");\r\n                this.reload();\r\n                return;\r\n            }\r\n\r\n            this.request.removeEventListener(\"load\", this.ready.bind(this), false);\r\n            this.request.removeEventListener(\"error\", this.error.bind(this), false);\r\n            this.request = null;\r\n            this.loaded = true;\r\n            //warn(\"Loaded: \" + this.options.name + \".\" + settings.supported[this.ext]);\r\n\r\n            this.decode();\r\n        },\r\n\r\n        decode: function () {\r\n            if (!audio) {\r\n                return;\r\n            }\r\n\r\n            audio.decodeAudioData(this.result.response, this.setBuffer.bind(this), this.error.bind(this));\r\n        },\r\n\r\n        setBuffer: function (buffer) {\r\n            this.options.buffer = buffer;\r\n            this.decoded = true;\r\n            //warn(\"Decoded: \" + this.options.name + \".\" + settings.supported[this.ext]);\r\n\r\n            var config = {\r\n                name: this.options.name,\r\n                alias: this.options.alias,\r\n                ext: this.options.supported[this.ext],\r\n                duration: this.options.buffer.duration\r\n            };\r\n\r\n            if (this.options.ready_callback && typeof this.options.ready_callback === \"function\") {\r\n                this.options.ready_callback.call(this.options.scope, config);\r\n            }\r\n\r\n            if (this.options.sprite) {\r\n\r\n                for (i in this.options.sprite) {\r\n                    this.options.start = this.options.sprite[i][0];\r\n                    this.options.end = this.options.sprite[i][1];\r\n                    this.streams[i] = new Stream(this.options, i);\r\n                }\r\n\r\n            } else {\r\n\r\n                this.streams[0] = new Stream(this.options);\r\n\r\n            }\r\n\r\n            if (this.autoplay) {\r\n                this.autoplay = false;\r\n                this.play();\r\n            }\r\n        },\r\n\r\n        error: function () {\r\n            this.reload();\r\n        },\r\n\r\n        play: function (options) {\r\n            delete this.options.part;\r\n\r\n            if (options) {\r\n                extend(options, this.options);\r\n            }\r\n\r\n            if (!this.loaded) {\r\n                this.autoplay = true;\r\n                this.load();\r\n\r\n                return;\r\n            }\r\n\r\n            if (this.no_file || !this.decoded) {\r\n                return;\r\n            }\r\n\r\n            if (this.options.sprite) {\r\n                if (this.options.part) {\r\n                    this.streams[this.options.part].play(this.options);\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        this.streams[i].play(this.options);\r\n                    }\r\n                }\r\n            } else {\r\n                this.streams[0].play(this.options);\r\n            }\r\n        },\r\n\r\n        stop: function (options) {\r\n            if (this.options.sprite) {\r\n\r\n                if (options) {\r\n                    this.streams[options.part].stop();\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        this.streams[i].stop();\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                this.streams[0].stop();\r\n            }\r\n        },\r\n\r\n        pause: function (options) {\r\n            if (this.options.sprite) {\r\n\r\n                if (options) {\r\n                    this.streams[options.part].pause();\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        this.streams[i].pause();\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                this.streams[0].pause();\r\n            }\r\n        },\r\n\r\n        volume: function (options) {\r\n            var stream;\r\n\r\n            if (options) {\r\n                extend(options, this.options);\r\n            } else {\r\n                return;\r\n            }\r\n\r\n            if (this.options.sprite) {\r\n                if (this.options.part) {\r\n                    stream = this.streams[this.options.part];\r\n                    stream && stream.setVolume(this.options);\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        stream = this.streams[i];\r\n                        stream && stream.setVolume(this.options);\r\n                    }\r\n                }\r\n            } else {\r\n                stream = this.streams[0];\r\n                stream && stream.setVolume(this.options);\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n\r\n    var Stream = function (options, sprite_part) {\r\n        this.alias = options.alias;\r\n        this.name = options.name;\r\n        this.sprite_part = sprite_part;\r\n\r\n        this.buffer = options.buffer;\r\n        this.start = options.start || 0;\r\n        this.end = options.end || this.buffer.duration;\r\n        this.multiplay = options.multiplay || false;\r\n        this.volume = options.volume || 1;\r\n        this.scope = options.scope;\r\n        this.ended_callback = options.ended_callback;\r\n\r\n        this.setLoop(options);\r\n\r\n        this.source = null;\r\n        this.gain = null;\r\n        this.playing = false;\r\n        this.paused = false;\r\n\r\n        this.time_started = 0;\r\n        this.time_ended = 0;\r\n        this.time_played = 0;\r\n        this.time_offset = 0;\r\n    };\r\n\r\n    Stream.prototype = {\r\n        destroy: function () {\r\n            this.stop();\r\n\r\n            this.buffer = null;\r\n            this.source = null;\r\n\r\n            this.gain && this.gain.disconnect();\r\n            this.source && this.source.disconnect();\r\n            this.gain = null;\r\n            this.source = null;\r\n        },\r\n\r\n        setLoop: function (options) {\r\n            if (options.loop === true) {\r\n                this.loop = 9999999;\r\n            } else if (typeof options.loop === \"number\") {\r\n                this.loop = +options.loop - 1;\r\n            } else {\r\n                this.loop = false;\r\n            }\r\n        },\r\n\r\n        update: function (options) {\r\n            this.setLoop(options);\r\n            if (\"volume\" in options) {\r\n                this.volume = options.volume;\r\n            }\r\n        },\r\n\r\n        play: function (options) {\r\n            if (options) {\r\n                this.update(options);\r\n            }\r\n\r\n            if (!this.multiplay && this.playing) {\r\n                return;\r\n            }\r\n\r\n            this.gain = audio.createGain();\r\n            this.source = audio.createBufferSource();\r\n            this.source.buffer = this.buffer;\r\n            this.source.connect(this.gain);\r\n            this.gain.connect(audio.destination);\r\n            this.gain.gain.value = this.volume;\r\n\r\n            this.source.onended = this.ended.bind(this);\r\n\r\n            this._play();\r\n        },\r\n\r\n        _play: function () {\r\n            var start,\r\n                end;\r\n\r\n            if (this.paused) {\r\n                start = this.start + this.time_offset;\r\n                end = this.end - this.time_offset;\r\n            } else {\r\n                start = this.start;\r\n                end = this.end;\r\n            }\r\n\r\n            if (end <= 0) {\r\n                this.clear();\r\n                return;\r\n            }\r\n\r\n            if (typeof this.source.start === \"function\") {\r\n                this.source.start(0, start, end);\r\n            } else {\r\n                this.source.noteOn(0, start, end);\r\n            }\r\n\r\n            this.playing = true;\r\n            this.paused = false;\r\n            this.time_started = new Date().valueOf();\r\n        },\r\n\r\n        stop: function () {\r\n            if (this.playing && this.source) {\r\n                if (typeof this.source.stop === \"function\") {\r\n                    this.source.stop(0);\r\n                } else {\r\n                    this.source.noteOff(0);\r\n                }\r\n            }\r\n\r\n            this.clear();\r\n        },\r\n\r\n        pause: function () {\r\n            if (this.paused) {\r\n                this.play();\r\n                return;\r\n            }\r\n\r\n            if (!this.playing) {\r\n                return;\r\n            }\r\n\r\n            this.source && this.source.stop(0);\r\n            this.paused = true;\r\n        },\r\n\r\n        ended: function () {\r\n            this.playing = false;\r\n            this.time_ended = new Date().valueOf();\r\n            this.time_played = (this.time_ended - this.time_started) / 1000;\r\n            this.time_offset += this.time_played;\r\n\r\n            if (this.time_offset >= this.end || this.end - this.time_offset < 0.015) {\r\n                this._ended();\r\n                this.clear();\r\n\r\n                if (this.loop) {\r\n                    this.loop--;\r\n                    this.play();\r\n                }\r\n            }\r\n        },\r\n\r\n        _ended: function () {\r\n            var config = {\r\n                name: this.name,\r\n                alias: this.alias,\r\n                part: this.sprite_part,\r\n                start: this.start,\r\n                duration: this.end\r\n            };\r\n\r\n            if (this.ended_callback && typeof this.ended_callback === \"function\") {\r\n                this.ended_callback.call(this.scope, config);\r\n            }\r\n        },\r\n\r\n        clear: function () {\r\n            this.time_played = 0;\r\n            this.time_offset = 0;\r\n            this.paused = false;\r\n            this.playing = false;\r\n        },\r\n\r\n        setVolume: function (options) {\r\n            this.volume = options.volume;\r\n\r\n            if (this.gain) {\r\n                this.gain.gain.value = this.volume;\r\n            }\r\n        }\r\n    };\r\n\r\n    if (audio) {\r\n        return;\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * Fallback for HTML5 audio\r\n     * - for not so modern browsers\r\n     */\r\n\r\n    var checkSupport = function () {\r\n        var sound = new Audio(),\r\n            can_play_mp3 = sound.canPlayType('audio/mpeg'),\r\n            can_play_ogg = sound.canPlayType('audio/ogg'),\r\n            can_play_aac = sound.canPlayType('audio/mp4; codecs=\"mp4a.40.2\"'),\r\n            item, i;\r\n\r\n        for (i = 0; i < settings.supported.length; i++) {\r\n            item = settings.supported[i];\r\n\r\n            if (!can_play_mp3 && item === \"mp3\") {\r\n                settings.supported.splice(i, 1);\r\n            }\r\n\r\n            if (!can_play_ogg && item === \"ogg\") {\r\n                settings.supported.splice(i, 1);\r\n            }\r\n\r\n            if (!can_play_aac && item === \"aac\") {\r\n                settings.supported.splice(i, 1);\r\n            }\r\n\r\n            if (!can_play_aac && item === \"mp4\") {\r\n                settings.supported.splice(i, 1);\r\n            }\r\n        }\r\n\r\n        sound = null;\r\n    };\r\n    checkSupport();\r\n\r\n\r\n\r\n    Sound.prototype = {\r\n        init: function (options) {\r\n            if (options) {\r\n                extend(options, this.options);\r\n            }\r\n\r\n            this.inited = true;\r\n\r\n            if (this.options.preload) {\r\n                this.load();\r\n            }\r\n        },\r\n\r\n        destroy: function () {\r\n            var stream;\r\n\r\n            for (i in this.streams) {\r\n                stream = this.streams[i];\r\n\r\n                if (stream) {\r\n                    stream.destroy();\r\n                    stream = null;\r\n                }\r\n            }\r\n            this.streams = {};\r\n            this.loaded = false;\r\n            this.inited = false;\r\n        },\r\n\r\n        load: function () {\r\n            var part;\r\n\r\n            this.options.preload = true;\r\n            this.options._ready = this.ready;\r\n            this.options._scope = this;\r\n\r\n            if (this.options.sprite) {\r\n\r\n                for (i in this.options.sprite) {\r\n                    part = this.options.sprite[i];\r\n\r\n                    this.options.start = part[0];\r\n                    this.options.end = part[1];\r\n\r\n                    this.streams[i] = new Stream(this.options, i);\r\n                }\r\n\r\n            } else {\r\n\r\n                this.streams[0] = new Stream(this.options);\r\n\r\n            }\r\n        },\r\n\r\n        ready: function (duration) {\r\n            if (this.loaded) {\r\n                return;\r\n            }\r\n\r\n            this.loaded = true;\r\n\r\n            var config = {\r\n                name: this.options.name,\r\n                alias: this.options.alias,\r\n                ext: this.options.supported[this.ext],\r\n                duration: duration\r\n            };\r\n\r\n            if (this.options.ready_callback && typeof this.options.ready_callback === \"function\") {\r\n                this.options.ready_callback.call(this.options.scope, config);\r\n            }\r\n\r\n            if (this.autoplay) {\r\n                this.autoplay = false;\r\n                this.play();\r\n            }\r\n        },\r\n\r\n        play: function (options) {\r\n            if (!this.inited) {\r\n                return;\r\n            }\r\n\r\n            delete this.options.part;\r\n\r\n            if (options) {\r\n                extend(options, this.options);\r\n            }\r\n\r\n            console.log(1);\r\n            if (!this.loaded) {\r\n                if (!this.options.preload) {\r\n                    this.autoplay = true;\r\n                    this.load();\r\n                } else {\r\n                    this.autoplay = true;\r\n                }\r\n\r\n                return;\r\n            }\r\n\r\n            if (this.options.sprite) {\r\n                if (this.options.part) {\r\n                    this.streams[this.options.part].play(this.options);\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        this.streams[i].play(this.options);\r\n                    }\r\n                }\r\n            } else {\r\n                this.streams[0].play(this.options);\r\n            }\r\n        },\r\n\r\n        stop: function (options) {\r\n            if (!this.inited) {\r\n                return;\r\n            }\r\n\r\n            if (this.options.sprite) {\r\n\r\n                if (options) {\r\n                    this.streams[options.part].stop();\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        this.streams[i].stop();\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                this.streams[0].stop();\r\n            }\r\n        },\r\n\r\n        pause: function (options) {\r\n            if (!this.inited) {\r\n                return;\r\n            }\r\n\r\n            if (this.options.sprite) {\r\n\r\n                if (options) {\r\n                    this.streams[options.part].pause();\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        this.streams[i].pause();\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                this.streams[0].pause();\r\n            }\r\n        },\r\n\r\n        volume: function (options) {\r\n            var stream;\r\n\r\n            if (options) {\r\n                extend(options, this.options);\r\n            } else {\r\n                return;\r\n            }\r\n\r\n            if (this.options.sprite) {\r\n                if (this.options.part) {\r\n                    stream = this.streams[this.options.part];\r\n                    stream && stream.setVolume(this.options);\r\n                } else {\r\n                    for (i in this.options.sprite) {\r\n                        stream = this.streams[i];\r\n                        stream && stream.setVolume(this.options);\r\n                    }\r\n                }\r\n            } else {\r\n                stream = this.streams[0];\r\n                stream && stream.setVolume(this.options);\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n\r\n    Stream = function (options, sprite_part) {\r\n        this.name = options.name;\r\n        this.alias = options.alias;\r\n        this.sprite_part = sprite_part;\r\n\r\n        this.multiplay = options.multiplay;\r\n        this.volume = options.volume;\r\n        this.preload = options.preload;\r\n        this.path = settings.path;\r\n        this.start = options.start || 0;\r\n        this.end = options.end || 0;\r\n        this.scope = options.scope;\r\n        this.ended_callback = options.ended_callback;\r\n\r\n        this._scope = options._scope;\r\n        this._ready = options._ready;\r\n\r\n        this.setLoop(options);\r\n\r\n        this.sound = null;\r\n        this.url = null;\r\n        this.loaded = false;\r\n\r\n        this.start_time = 0;\r\n        this.paused_time = 0;\r\n        this.played_time = 0;\r\n\r\n        this.init();\r\n    };\r\n\r\n    Stream.prototype = {\r\n        init: function () {\r\n            this.sound = new Audio();\r\n            this.sound.volume = this.volume;\r\n\r\n            this.createUrl();\r\n\r\n            this.sound.addEventListener(\"ended\", this.ended.bind(this), false);\r\n            this.sound.addEventListener(\"canplaythrough\", this.can_play_through.bind(this), false);\r\n            this.sound.addEventListener(\"timeupdate\", this._update.bind(this), false);\r\n\r\n            this.load();\r\n        },\r\n\r\n        destroy: function () {\r\n            this.stop();\r\n\r\n            this.sound.removeEventListener(\"ended\", this.ended.bind(this), false);\r\n            this.sound.removeEventListener(\"canplaythrough\", this.can_play_through.bind(this), false);\r\n            this.sound.removeEventListener(\"timeupdate\", this._update.bind(this), false);\r\n\r\n            this.sound = null;\r\n            this.loaded = false;\r\n        },\r\n\r\n        createUrl: function () {\r\n            var rand = new Date().valueOf();\r\n            this.url = this.path + encodeURIComponent(this.name) + \".\" + settings.supported[0] + \"?\" + rand;\r\n        },\r\n\r\n        can_play_through: function () {\r\n            if (this.preload) {\r\n                this.ready();\r\n            }\r\n        },\r\n\r\n        load: function () {\r\n            this.sound.src = this.url;\r\n            this.sound.preload = this.preload ? \"auto\" : \"none\";\r\n            if (this.preload) {\r\n                this.sound.load();\r\n            }\r\n        },\r\n\r\n        setLoop: function (options) {\r\n            if (options.loop === true) {\r\n                this.loop = 9999999;\r\n            } else if (typeof options.loop === \"number\") {\r\n                this.loop = +options.loop - 1;\r\n            } else {\r\n                this.loop = false;\r\n            }\r\n        },\r\n\r\n        update: function (options) {\r\n            this.setLoop(options);\r\n\r\n            if (\"volume\" in options) {\r\n                this.volume = options.volume;\r\n            }\r\n        },\r\n\r\n        ready: function () {\r\n            if (this.loaded || !this.sound) {\r\n                return;\r\n            }\r\n\r\n            this.loaded = true;\r\n            this._ready.call(this._scope, this.sound.duration);\r\n\r\n            if (!this.end) {\r\n                this.end = this.sound.duration;\r\n            }\r\n        },\r\n\r\n        play: function (options) {\r\n            if (options) {\r\n                this.update(options);\r\n            }\r\n\r\n            if (!this.multiplay && this.playing) {\r\n                return;\r\n            }\r\n\r\n            this._play();\r\n        },\r\n\r\n        _play: function () {\r\n            if (this.paused) {\r\n                this.paused = false;\r\n            } else {\r\n                try {\r\n                    this.sound.currentTime = this.start;\r\n                } catch (e) {}\r\n            }\r\n\r\n            this.playing = true;\r\n            this.start_time = new Date().valueOf();\r\n            this.sound.volume = this.volume;\r\n            this.sound.play();\r\n        },\r\n\r\n        stop: function () {\r\n            if (!this.playing) {\r\n                return;\r\n            }\r\n\r\n            this.playing = false;\r\n            this.paused = false;\r\n            this.sound.pause();\r\n            this.clear();\r\n\r\n            try {\r\n                this.sound.currentTime = this.start;\r\n            } catch (e) {}\r\n        },\r\n\r\n        pause: function () {\r\n            if (this.paused) {\r\n                this._play();\r\n            } else {\r\n                this.playing = false;\r\n                this.paused = true;\r\n                this.sound.pause();\r\n                this.paused_time = new Date().valueOf();\r\n                this.played_time += this.paused_time - this.start_time;\r\n            }\r\n        },\r\n\r\n        _update: function () {\r\n            if (!this.start_time) {\r\n                return;\r\n            }\r\n\r\n            var current_time = new Date().valueOf(),\r\n                played_time = current_time - this.start_time,\r\n                played = (this.played_time + played_time) / 1000;\r\n\r\n            if (played >= this.end) {\r\n                if (this.playing) {\r\n                    this.stop();\r\n                    this._ended();\r\n                }\r\n            }\r\n        },\r\n\r\n        ended: function () {\r\n            if (this.playing) {\r\n                this.stop();\r\n                this._ended();\r\n            }\r\n        },\r\n\r\n        _ended: function () {\r\n            this.playing = false;\r\n\r\n            var config = {\r\n                name: this.name,\r\n                alias: this.alias,\r\n                part: this.sprite_part,\r\n                start: this.start,\r\n                duration: this.end\r\n            };\r\n\r\n            if (this.ended_callback && typeof this.ended_callback === \"function\") {\r\n                this.ended_callback.call(this.scope, config);\r\n            }\r\n\r\n            if (this.loop) {\r\n                setTimeout(this.looper.bind(this), 15);\r\n            }\r\n        },\r\n\r\n        looper: function () {\r\n            this.loop--;\r\n            this.play();\r\n        },\r\n\r\n        clear: function () {\r\n            this.start_time = 0;\r\n            this.played_time = 0;\r\n            this.paused_time = 0;\r\n        },\r\n\r\n        setVolume: function (options) {\r\n            this.volume = options.volume;\r\n\r\n            if (this.sound) {\r\n                this.sound.volume = this.volume;\r\n            }\r\n        }\r\n    };\r\n\r\n} (window, navigator, window.jQuery || window.$));\r\n","import './vendor/ion.sound';\r\n\r\nconst NOTES = {\r\n  SNAP: 'snap',\r\n  K: 'bell_ring',\r\n  \"F,\": 'bell_ring',\r\n  \"C,\": 'bell_ring',\r\n  \"D,\": 'bell_ring',\r\n  \"E,\": 'bell_ring',\r\n  A: 'bell_ring',\r\n  B: 'bell_ring',\r\n  C: 'bell_ring',\r\n  D: 'bell_ring',\r\n  E: 'bell_ring',\r\n  F: 'bell_ring',\r\n  G: 'bell_ring',\r\n  c: 'bell_ring',\r\n  d: 'bell_ring',\r\n  e: 'bell_ring',\r\n  f: 'bell_ring',\r\n  g: 'bell_ring',\r\n  b: 'bell_ring',\r\n  \"c'\": 'bell_ring',\r\n  \"d'\": 'bell_ring',\r\n  \"e'\": 'bell_ring',\r\n  \"f'\": 'bell_ring',\r\n  \"g'\": 'bell_ring',\r\n  \"a'\": 'bell_ring',\r\n};\r\n\r\nconst Player = (function () {\r\n  let instance;\r\n\r\n  function GlobalPlayer() {\r\n    const ion = window.ion;\r\n\r\n    ion.sound({\r\n      sounds: Object.values(NOTES).map(name => ({\r\n        name,\r\n        volume: name === NOTES.SNAP\r\n          ? 1.0\r\n          : 0.3\r\n      })),\r\n      path: \"sounds/\",\r\n      preload: true,\r\n      multiplay: true\r\n    });\r\n\r\n    return {\r\n      playNote: (note) => {\r\n        if (NOTES[note]) {\r\n          ion.sound.play(NOTES[note]);\r\n        }\r\n      },\r\n      playSnap: () => {\r\n        ion.sound.play(NOTES.SNAP);\r\n      },\r\n    }\r\n  }\r\n\r\n  return function() {\r\n    if (!instance) {\r\n      instance = new GlobalPlayer();\r\n    }\r\n\r\n    return instance;\r\n  }\r\n}());\r\n\r\nexport default Player;\r\n","export default function noop() {}\r\n","const second = 1000;\r\nconst minute = second * 60;\r\nimport noop from \"./helpers/noop\";\r\n\r\nexport default function Ticker({\r\n  ticksPerMinute = 60,\r\n  onTick = noop\r\n} = {}) {\r\n  let tpm = ticksPerMinute;\r\n  let interval;\r\n\r\n  function stop() {\r\n    clearInterval(interval);\r\n\r\n    interval = null;\r\n  }\r\n\r\n  function start() {\r\n    stop();\r\n\r\n    interval = setInterval(onTick, minute / tpm);\r\n  }\r\n\r\n  function update({ticksPerMinute}) {\r\n    tpm = ticksPerMinute;\r\n\r\n    if (interval) {\r\n      start();\r\n    }\r\n  }\r\n\r\n  return {\r\n    start,\r\n    stop,\r\n    update\r\n  }\r\n}\r\n","import noop from \"./helpers/noop\";\r\nimport createElement from \"./helpers/createElement\";\r\nimport __ from \"./helpers/translate\";\r\n\r\nexport default function ControllerView({\r\n  onPlay = noop,\r\n  onStop = noop,\r\n  onClickSlower = noop,\r\n  onClickFaster = noop,\r\n  viewerElement,\r\n  block = 'harp-view',\r\n  bpm\r\n} = {}) {\r\n  const state = {\r\n    playing: false,\r\n    bpm\r\n  };\r\n\r\n  const $el = createElement('div', block);\r\n  const playButton = createElement('button', `${block}__play`, {\r\n    click: function() {\r\n      if (!state.playing) {\r\n        onPlay();\r\n      } else {\r\n        onStop();\r\n      }\r\n    }\r\n  });\r\n\r\n  function updateButton() {\r\n    playButton.innerText = __(!state.playing ? 'play' : 'stop');\r\n  }\r\n\r\n  updateButton();\r\n\r\n  const controlSpeed = createElement('span', `${block}__control-speed`);\r\n  Object.assign(controlSpeed.style, {\r\n    display: 'inline-block',\r\n    margin: '0 1em'\r\n  });\r\n\r\n  const slowerBtn = createElement('button', `${block}__speed-button`, {\r\n    click: onClickSlower\r\n  });\r\n  slowerBtn.innerText = __('slower');\r\n\r\n  const fasterBtn = createElement('button', `${block}__speed-button`, {\r\n    click: onClickFaster\r\n  });\r\n  fasterBtn.innerText = __('faster');\r\n\r\n  const bpmElement = createElement('span', `${block}__bpm`);\r\n  Object.assign(bpmElement.style, {\r\n    display: 'inline-block',\r\n    margin: '0 0.5em'\r\n  });\r\n\r\n  function updateBpm() {\r\n    bpmElement.innerText = state.bpm || '';\r\n  }\r\n\r\n  controlSpeed.appendChild(slowerBtn);\r\n  controlSpeed.appendChild(bpmElement);\r\n  controlSpeed.appendChild(fasterBtn);\r\n\r\n  updateBpm();\r\n\r\n  $el.appendChild(playButton);\r\n  $el.appendChild(controlSpeed);\r\n\r\n  const viewerContainer = createElement('div', `${block}__viewer`);\r\n  Object.assign(viewerContainer.style, {\r\n    maxWidth: '320px',\r\n    margin: '0 auto'\r\n  });\r\n\r\n  viewerContainer.appendChild(viewerElement);\r\n  $el.appendChild(viewerContainer);\r\n\r\n  const updateElement = {\r\n    playing: updateButton,\r\n    bpm: updateBpm\r\n  };\r\n\r\n  function update(newState) {\r\n    Object.entries(newState).forEach(([key, value]) => {\r\n      if (state[key] !== value) {\r\n        state[key] = value;\r\n\r\n        updateElement[key]();\r\n      }\r\n    });\r\n  }\r\n\r\n  return {\r\n    $el,\r\n    update\r\n  }\r\n}\r\n","const PAUSES = new Set(['x', 'z']);\r\n\r\nconst isPause = note => PAUSES.has(note);\r\n\r\nexport default isPause;\r\n","import Viewer from './viewer';\r\nimport Player from './player';\r\nimport Ticker from './ticker';\r\nimport ControllerView from \"./controller-view\";\r\nimport isPause from './helpers/isPause';\r\n\r\nexport default function Controller({tune}) {\r\n  let tick = -1;\r\n  let tuneIndex = -1;\r\n  let ticksPerMinute = 120 * 4;\r\n\r\n  const ticksPerMinuteSteps = [0.2, 0.4, 0.6, 0.8, 1, 1.2, 1.4, 1.6, 1.8, 2, 2.5, 3, 3.5, 4]\r\n    .map(multiplier => Math.round(ticksPerMinute * multiplier));\r\n\r\n  let currentTicksStep = ticksPerMinuteSteps.findIndex(tpm => tpm === ticksPerMinute);\r\n\r\n  const modifiers = ['\\'', ','];\r\n\r\n  const tuneArray = tune\r\n    .split('')\r\n    .reduce((result, symbol) => {\r\n      let note = modifiers.includes(symbol)\r\n        ? result.pop() + symbol\r\n        : symbol;\r\n\r\n      result.push(note);\r\n\r\n      return result;\r\n    }, []);\r\n  const ticksPerSnap = 4;\r\n  const ticksPerNote = 2;\r\n  const highLightTicks = 1;\r\n\r\n  const viewer = new Viewer();\r\n  const player = new Player();\r\n\r\n  const playAndShow = () => {\r\n    const note = tuneArray[tuneIndex];\r\n\r\n    viewer.dimAll();\r\n\r\n    if (isPause(note)) {\r\n      return;\r\n    }\r\n\r\n    player.playNote(note);\r\n    viewer.highLight(note);\r\n  };\r\n\r\n  let ticker;\r\n  let controllerView;\r\n\r\n  const stop = () => {\r\n    tick = -1;\r\n    tuneIndex = -1;\r\n\r\n    controllerView.update({playing: false});\r\n    ticker.stop();\r\n    viewer.dimAll();\r\n  };\r\n\r\n  const onTick = () => {\r\n    tick += 1;\r\n\r\n    if (tick % ticksPerNote === highLightTicks) {\r\n      viewer.dimAll();\r\n    }\r\n\r\n    if (tick % ticksPerNote === 0) {\r\n      tuneIndex += 1;\r\n\r\n      if (tuneIndex === tuneArray.length) {\r\n        return stop();\r\n      }\r\n\r\n      playAndShow();\r\n    }\r\n\r\n    if (tick % ticksPerSnap === 0) {\r\n      player.playSnap();\r\n    }\r\n  };\r\n\r\n  ticker = new Ticker({\r\n    ticksPerMinute,\r\n    onTick\r\n  });\r\n\r\n  const speedStep = (increment) => {\r\n    currentTicksStep = Math.max(0, Math.min((currentTicksStep + increment), ticksPerMinuteSteps.length - 1));\r\n\r\n    ticksPerMinute = ticksPerMinuteSteps[currentTicksStep];\r\n\r\n    ticker.update({ticksPerMinute});\r\n    controllerView.update({bpm: ticksPerMinute / ticksPerSnap});\r\n  };\r\n\r\n  controllerView = new ControllerView({\r\n    viewerElement: viewer.$el,\r\n\r\n    bpm: ticksPerMinute / ticksPerSnap,\r\n\r\n    onClickFaster() {\r\n      speedStep(+1);\r\n    },\r\n\r\n    onClickSlower() {\r\n      speedStep(-1);\r\n    },\r\n\r\n    onPlay() {\r\n      controllerView.update({playing: true});\r\n\r\n      ticker.start();\r\n    },\r\n    onStop: stop\r\n  });\r\n\r\n  return controllerView.$el;\r\n}\r\n","import insertAfter from './helpers/insertAfter';\r\nimport __ from './helpers/translate';\r\nimport tuneValid from './helpers/tuneValid';\r\nimport Controller from \"./controller\";\r\n\r\nwindow.HarpView = function(selector) {\r\n  document.querySelectorAll('.' + selector).forEach(node => {\r\n    const tune = node.innerHTML.trim();\r\n\r\n    if (!tuneValid(tune)) {\r\n      console.error(__('error.bad-tune'), node);\r\n\r\n      return;\r\n    }\r\n\r\n    insertAfter(new Controller({tune}), node);\r\n  });\r\n};\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}